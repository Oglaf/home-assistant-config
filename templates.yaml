- sensor:
    - name: "Tariff price"
      unique_id: 01933acb-183d-7526-b92b-8df18246fbc9
      unit_of_measurement: BRL/kWh
      state: >
        {% if is_state('input_select.tariff_type', 'Peak') %}
          {{ 1.45522 }}
        {% elif is_state('input_select.tariff_type', 'Shoulder') %}
          {{ 0.96261 }}
        {% elif is_state('input_select.tariff_type', 'Off peak') %}
          {{ 0.67977 }}
        {% endif %}

    # Presence detection
    - name: "christian_christian_sp_home"
      state: >-
        {%
          if (states('sensor.christian_sp_wi_fi_connection') == "ZAITSU") 
          or (states('sensor.christian_sp_wi_fi_connection') == "ZAITSU_2G")
        %}
          home
        {% else %}
          not_home
        {% endif %}

    - name: "cecilia_redminote8_home"
      state: >-
        {%
          if (states('sensor.cecilia_sp_wifi_connection') == "ZAITSU") 
          or (states('sensor.cecilia_sp_wifi_connection') == "ZAITSU_2G")
        %}
          home
        {% else %}
          not_home
        {% endif %}

    # Speedtest sensors
    - name: "SpeedTest CLI Ping"
      unique_id: speedtest_cli_ping
      icon: mdi:speedometer
      unit_of_measurement: ms
      state_class: measurement
      state: "{{ (states('sensor.speedtest_cli_data') | from_json).ping | round(2) }}"

    - name: "SpeedTest CLI Download"
      unique_id: speedtest_cli_download
      icon: mdi:speedometer
      unit_of_measurement: MB/s
      state_class: measurement
      state: "{{ ((states('sensor.speedtest_cli_data') | from_json).download / 125000) | round(2) }}"

    - name: "SpeedTest CLI Upload"
      unique_id: speedtest_cli_upload
      icon: mdi:speedometer
      unit_of_measurement: MB/s
      state_class: measurement
      state: "{{ ((states('sensor.speedtest_cli_data') | from_json).upload / 125000) | round(2) }}"

    # Sun
    - name: "next_sunrise"
      state: >-
        {{ as_timestamp(states.sun.sun.attributes.next_rising) | timestamp_custom('%H:%M') }}

    - name: "next_sunset"
      state: >-
        {{ as_timestamp(states.sun.sun.attributes.next_setting) | timestamp_custom('%H:%M') }}

    - name: "GPU Power"
      unique_id: gpu_power_draw
      icon: mdi:lightning-bolt
      unit_of_measurement: W
      state_class: measurement
      device_class: power
      state: >-
       {{ ((states('sensor.gpu_data') | from_json).gpu_power_draw) | round(2) }}

    - name: "GPU Temperature"
      unique_id: gpu_temperature
      unit_of_measurement: Â°C
      state_class: measurement
      device_class: temperature
      state: >-
        {{ ((states('sensor.gpu_data') | from_json).gpu_temperature) | round(2) }}

    - name: "GPU Utilization"
      unique_id: gpu_utilization
      icon: mdi:speedometer
      unit_of_measurement: "%"
      state_class: measurement
      state: >-
        {{ ((states('sensor.gpu_data') | from_json).gpu_utilization) | round(2) }}

    - name: "GPU Memory Utilization"
      unique_id: gpu_memory_utilization
      icon: mdi:speedometer
      unit_of_measurement: "MB"
      state_class: measurement
      state: >-
        {{ ((states('sensor.gpu_data') | from_json).gpu_memory_utilization) | round(2) }}